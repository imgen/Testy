// See https://aka.ms/new-console-template for more information

using Aspose.Pdf;
using Aspose.Pdf.Facades;
using Aspose.Pdf.Forms;

const string certificateAsBase64String =
    "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";
var certificateBytes = Convert.FromBase64String(certificateAsBase64String);
var ms = new MemoryStream(certificateBytes);
using var document = new Document("Invoice.pdf");
using var signature = new PdfFileSignature(document);
var pkcs = new PKCS7(ms, ""); // 
signature.Sign(1, false, new System.Drawing.Rectangle(300, 100, 400, 200), pkcs);
// Save output PDF file
signature.Save("Invoice_signed.pdf");